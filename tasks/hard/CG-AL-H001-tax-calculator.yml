id: CG-AL-H001
prompt_template: code-gen.md
fix_template: bugfix.md
max_attempts: 2
description: >-
  Create a codeunit called "Tax Calculator" with ID 70100.
  The codeunit should implement international tax calculation with the following procedure:

  CalculateTax(Amount: Decimal; CountryCode: Code[2]; ProductType: Enum "CG Product Type"): Decimal

  The enum "CG Product Type" is provided by the test app with values: Standard (0), Food (1), Books (2).

  Tax rules by country:

  US (United States):
  - Amount < 100: 0% tax
  - 100 <= Amount < 1000: 7% tax
  - Amount >= 1000: 8.5% tax
  - ProductType has no effect on US tax rates

  DE (Germany):
  - ProductType = Food: 7% tax (reduced rate)
  - All other ProductTypes: 19% tax (standard rate)
  - Amount thresholds do not apply

  UK (United Kingdom):
  - ProductType = Books: 0% tax (zero-rated)
  - All other ProductTypes: 20% tax (standard rate)
  - Amount thresholds do not apply

  Other countries:
  - Return 0 (no tax calculation available)

  Edge cases:
  - Negative amounts: return 0
  - Zero amount: return 0

  All results must be rounded to 2 decimal places.
  Include Access = Public on the codeunit.
expected:
  compile: true
  testApp: tests/al/hard/CG-AL-H001.Test.al
  testCodeunitId: 80101
metrics:
  - compile_pass
  - tests_pass
  - pass_attempt
