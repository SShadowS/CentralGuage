id: CG-AL-E031
prompt_template: code-gen.md
fix_template: bugfix.md
max_attempts: 2
description: >-
  Create a table called "CG Subscription Plan" with ID 70031.

  Table properties:
  - Caption = 'CG Subscription Plan'
  - DataClassification = CustomerContent

  Fields:
  1. Code (Code[20], primary key, NotBlank = true)
  2. Description (Text[100])
  3. Monthly Fee (Decimal)
  4. Active (Boolean, InitValue = true)
  5. Created Date (Date)
  6. Last Modified DateTime (DateTime)

  Keys:
  - PK on Code, Clustered = true

  Behavior:
  - Monthly Fee OnValidate: if Monthly Fee < 0 then error. Error text must be exactly: "Monthly Fee cannot be negative"
  - OnInsert trigger:
    - If Created Date is 0D, set it to WorkDate()
    - Set Last Modified DateTime to CurrentDateTime
  - OnModify trigger:
    - Set Last Modified DateTime to CurrentDateTime
  - OnDelete trigger:
    - If Active is true, block deletion with error text exactly: "Cannot delete active subscription plan"
expected:
  compile: true
  testApp: tests/al/easy/CG-AL-E031.Test.al
  testCodeunitId: 80031
metrics:
  - compile_pass
  - tests_pass
  - pass_attempt
