id: CG-AL-M002
prompt_template: code-gen.md
fix_template: bugfix.md
max_attempts: 2
description: >-
  Create a comprehensive business logic codeunit called "Sales Order Calculator" with ID 70001.
  The codeunit should implement sales calculations including:
  - CalculateLineTotal(Quantity: Decimal; UnitPrice: Decimal): Decimal - basic calculation
  - CalculateLineTotal(Quantity: Decimal; UnitPrice: Decimal; DiscountPercent: Decimal): Decimal - with discount
  - CalculateOrderTotal(LineTotals: List of [Decimal]): Decimal - sum all line totals from list
  - ApplyVolumeDiscount(OrderTotal: Decimal): Decimal - apply tiered discounts:
    * Under 1000: no discount
    * 1000-5000: 5% discount
    * Over 5000: 10% discount
  - ValidateOrderLimits(OrderAmount: Decimal): Boolean - validate order is within acceptable range (10-100000)
  - CalculateTaxAmount(NetAmount: Decimal; TaxRate: Decimal): Decimal

  Include proper error handling: CalculateLineTotal should raise 'Quantity must be positive' for negative quantities
  and 'Price must be positive' for negative prices.
  Follow Business Central patterns with proper Access = Public.
expected:
  compile: true
  testApp: tests/al/medium/CG-AL-M002.Test.al
metrics:
  - compile_pass
  - tests_pass
  - pass_attempt
