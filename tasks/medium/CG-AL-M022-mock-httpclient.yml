id: CG-AL-M022
prompt_template: code-gen.md
fix_template: bugfix.md
max_attempts: 2
description: >-
  Create a codeunit named "CG Weather Service" with ID 70122 that makes HTTP calls to an
  external weather API. This tests whether the LLM can properly implement HttpClient usage.

  1. Procedure "GetTemperature" that takes Text parameter City and returns Decimal.
     Make a GET request to "https://api.weather.example/temperature?city=[City]".
     Parse the JSON response which has format: {"city": "London", "temperature": 15.5, "unit": "C"}
     Return the temperature value. Return 0 if the request fails.

  2. Procedure "PostWeatherReport" that takes Text parameter ReportJson and returns Boolean.
     Make a POST request to "https://api.weather.example/reports" with ReportJson as the body.
     Set Content-Type header to "application/json".
     Return true if response status code is 200 or 201, false otherwise.

  3. Procedure "GetForecast" that takes Text parameter City and Integer parameter Days,
     returns Text.
     Make a GET request to "https://api.weather.example/forecast?city=[City]&days=[Days]".
     Return the raw response content as text. Return empty string if request fails.

  4. Procedure "IsServiceAvailable" that returns Boolean.
     Make a GET request to "https://api.weather.example/health".
     Return true if response status is 200, false otherwise.

  Include Access = Public on the codeunit.
  Use HttpClient, HttpRequestMessage, HttpResponseMessage, and HttpContent appropriately.
metadata:
  target: OnPrem
expected:
  compile: true
  testApp: tests/al/medium/CG-AL-M022.Test.al
metrics:
  - compile_pass
  - tests_pass
  - pass_attempt
